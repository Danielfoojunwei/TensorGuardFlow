<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorGuard Enterprise PLM v2.1</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Tailwind CSS (Dev CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Titillium Web"', 'sans-serif'],
                        mono: ['"Titillium Web"', 'monospace'],
                    },
                }
            }
        }
    </script>
    <link rel="stylesheet" href="styles.css">
</head>

<body x-data="app()" x-init="init()" class="antialiased min-h-screen">

    <div class="main-grid">
        <!-- Sidebar -->
        <aside
            class="bg-[#0f0f17] border-r border-white/5 flex flex-col p-6 fixed h-full w-[260px] overflow-y-auto z-50">
            <div class="flex items-center gap-3 mb-8 overflow-hidden">
                <div
                    class="w-8 h-8 rounded-lg bg-sky-500 flex-shrink-0 flex items-center justify-center text-white font-bold">
                    T</div>
                <div class="flex flex-col">
                    <span class="font-bold text-sm tracking-tight">TensorGuard</span>
                    <span class="text-[10px] text-white/40 uppercase tracking-widest font-semibold">Enterprise PLM
                        v2.1</span>
                </div>
            </div>

            <!-- System Health Indicator -->
            <div class="mb-6 p-3 rounded-lg bg-gradient-to-r from-emerald-500/10 to-transparent border border-emerald-500/20"
                x-show="systemHealth.status === 'healthy'">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    <span class="text-xs text-emerald-400 font-medium">System Healthy</span>
                </div>
            </div>
            <div class="mb-6 p-3 rounded-lg bg-gradient-to-r from-amber-500/10 to-transparent border border-amber-500/20"
                x-show="systemHealth.status === 'degraded'">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-amber-500 animate-pulse"></span>
                    <span class="text-xs text-amber-400 font-medium">Degraded Mode</span>
                </div>
            </div>
            <div class="mb-6 p-3 rounded-lg bg-gradient-to-r from-red-500/10 to-transparent border border-red-500/20"
                x-show="systemHealth.status === 'unhealthy'">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                    <span class="text-xs text-red-400 font-medium">System Unhealthy</span>
                </div>
            </div>

            <nav class="space-y-1 flex-1">
                <div class="text-[10px] text-white/30 uppercase tracking-widest font-bold mb-2 mt-2">Overview</div>
                <div @click="activeTab = 'dashboard'" class="sidebar-link"
                    :class="{'active': activeTab === 'dashboard'}">
                    <i data-lucide="layout-dashboard"></i> <span>Dashboard</span>
                </div>
                <!-- Added PEFT Studio -->
                <div @click="activeTab = 'peft-studio'" class="sidebar-link"
                    :class="{'active': activeTab === 'peft-studio'}">
                    <i data-lucide="zap" class="text-amber-400"></i> <span>PEFT Studio</span>
                </div>

                <div class="text-[10px] text-white/30 uppercase tracking-widest font-bold mb-2 mt-6">Operations</div>
                <div @click="activeTab = 'pipeline'" class="sidebar-link" :class="{'active': activeTab === 'pipeline'}">
                    <i data-lucide="git-merge"></i> <span>Pipeline Monitor</span>
                    <span x-show="pipelineErrors > 0"
                        class="ml-auto bg-red-500 text-white text-[9px] px-1.5 py-0.5 rounded-full"
                        x-text="pipelineErrors"></span>
                </div>
                <div @click="activeTab = 'errors'" class="sidebar-link" :class="{'active': activeTab === 'errors'}">
                    <i data-lucide="alert-circle"></i> <span>Error Console</span>
                    <span x-show="errorCount > 0"
                        class="ml-auto bg-amber-500 text-white text-[9px] px-1.5 py-0.5 rounded-full"
                        x-text="errorCount"></span>
                </div>
                <!-- Added Fleets -->
                <div @click="activeTab = 'fleets'" class="sidebar-link" :class="{'active': activeTab === 'fleets'}">
                    <i data-lucide="server-cog"></i> <span>Fleets & Devices</span>
                </div>
                <div @click="activeTab = 'config'" class="sidebar-link" :class="{'active': activeTab === 'config'}">
                    <i data-lucide="settings"></i> <span>Configuration</span>
                </div>

                <div class="text-[10px] text-white/30 uppercase tracking-widest font-bold mb-2 mt-6">Security</div>
                <div @click="activeTab = 'keys'" class="sidebar-link" :class="{'active': activeTab === 'keys'}">
                    <i data-lucide="key"></i> <span>Key Management</span>
                    <span x-show="keysNeedingRotation > 0"
                        class="ml-auto bg-amber-500 text-white text-[9px] px-1.5 py-0.5 rounded-full"
                        x-text="keysNeedingRotation"></span>
                </div>
                <div @click="activeTab = 'vault'" class="sidebar-link" :class="{'active': activeTab === 'vault'}">
                    <i data-lucide="shield"></i> <span>Identity Vault</span>
                </div>
                <div @click="activeTab = 'compliance'" class="sidebar-link"
                    :class="{'active': activeTab === 'compliance'}">
                    <i data-lucide="shield-check"></i> <span>Compliance</span>
                </div>

                <div class="text-[10px] text-white/30 uppercase tracking-widest font-bold mb-2 mt-6">Lineage</div>
                <div @click="activeTab = 'lineage'" class="sidebar-link" :class="{'active': activeTab === 'lineage'}">
                    <i data-lucide="git-branch"></i> <span>Model Lineage</span>
                </div>
            </nav>
            <div class="mt-auto border-t border-white/5 pt-4">
                <div class="flex items-center gap-3">
                    <div
                        class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold text-sky-400">
                        DF</div>
                    <div class="flex flex-col">
                        <span class="text-xs font-semibold text-white/80">Daniel Foo</span>
                        <span class="text-[10px] text-white/30">ORG_ADMIN</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="col-start-2 min-h-screen">
            <header
                class="h-16 border-b border-white/5 flex items-center px-10 sticky top-0 bg-[#0a0a0f]/80 backdrop-blur z-40 justify-between">
                <div class="flex items-center gap-4 text-xs text-white/40 font-mono">
                    <span class="text-white/60" x-text="currentTime"></span>
                    <span class="mx-2">|</span>
                    <span class="flex items-center gap-1">
                        <span class="w-2 h-2 rounded-full"
                            :class="systemHealth.status === 'healthy' ? 'bg-emerald-500' : systemHealth.status === 'degraded' ? 'bg-amber-500' : 'bg-red-500'"></span>
                        <span
                            :class="systemHealth.status === 'healthy' ? 'text-emerald-500' : systemHealth.status === 'degraded' ? 'text-amber-500' : 'text-red-500'"
                            x-text="(degradation?.level || 'unknown').toUpperCase()"></span>
                    </span>
                    <span class="mx-2">|</span>
                    <!-- Controls from Robotics VLA -->
                    <div class="flex items-center gap-2 cursor-pointer bg-white/5 px-2 py-1 rounded border border-white/10"
                        @click="togglePQC()" title="Quantum-Resistant Encryption">
                        <div class="w-6 h-3 rounded-full relative transition-colors"
                            :class="security.pqc ? 'bg-orange-500' : 'bg-[#30363d]'">
                            <div class="w-2.5 h-2.5 bg-white rounded-full absolute top-[1px] transition-all"
                                :style="security.pqc ? 'left: 13px' : 'left: 1px'"></div>
                        </div>
                        <span class="text-[9px] font-mono"
                            :class="security.pqc ? 'text-white' : 'text-[#8b949e]'">PQC</span>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button @click="refreshAll()"
                        class="bg-white/5 hover:bg-white/10 px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 transition-colors flex items-center gap-2">
                        <i data-lucide="refresh-cw" class="w-3 h-3"></i> Refresh
                    </button>
                    <button @click="generateReport()"
                        class="bg-white/5 hover:bg-white/10 px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 transition-colors">
                        Export Report
                    </button>
                    <button
                        class="bg-sky-600 hover:bg-sky-500 px-3 py-1.5 rounded-md text-xs font-medium transition-colors shadow-lg shadow-sky-600/20">
                        New Training Run
                    </button>
                </div>
            </header>

            <main class="content-area">
                <!-- Dashboard Tab -->
                <div x-show="activeTab === 'dashboard'" x-transition x-cloak>
                    <<<<<<< HEAD <!-- Top Stats Row -->
                        <div class="grid grid-cols-5 gap-4 mb-8">
                            <!-- System Health Card -->
                            <div class="plm-card gradient-card-green">
                                <span
                                    class="text-[10px] text-white/60 uppercase font-bold tracking-wider mb-1 block">System
                                    Health</span>
                                <div class="flex items-end gap-2">
                                    <span class="text-3xl font-bold font-mono"
                                        x-text="systemHealth.healthy_count + '/' + systemHealth.total_count"></span>
                                    <span class="text-emerald-400 text-xs mb-1">Components</span>
                                </div>
                                <div class="mt-2 flex gap-1">
                                    <span class="text-[9px] text-emerald-400 bg-emerald-500/20 px-1.5 py-0.5 rounded"
                                        x-text="systemHealth.healthy_count + ' healthy'"></span>
                                    <span x-show="systemHealth.degraded_count > 0"
                                        class="text-[9px] text-amber-400 bg-amber-500/20 px-1.5 py-0.5 rounded"
                                        x-text="systemHealth.degraded_count + ' degraded'"></span>
                                </div>
                            </div>

                            <!-- Active Pipelines Card -->
                            <div class="plm-card gradient-card-blue">
                                <span
                                    class="text-[10px] text-white/60 uppercase font-bold tracking-wider mb-1 block">Active
                                    Pipelines</span>
                                <div class="flex items-end gap-2">
                                    <span class="text-3xl font-bold font-mono"
                                        x-text="pipelines.filter(p => p.status === 'healthy').length"></span>
                                    <span class="text-sky-400 text-xs mb-1 flex items-center gap-1">
                                        <span class="w-1.5 h-1.5 rounded-full bg-sky-400 animate-pulse"></span>
                                        Running
                                    </span>
                                </div>
                            </div>

                            <!-- Circuit Breakers Card -->
                            <div class="plm-card gradient-card-purple">
                                <span
                                    class="text-[10px] text-white/60 uppercase font-bold tracking-wider mb-1 block">Circuit
                                    Breakers</span>
                                <div class="flex items-end gap-2">
                                    <span class="text-3xl font-bold font-mono" x-text="circuits.length"></span>
                                    <span :class="openCircuits.length > 0 ? 'text-red-400' : 'text-emerald-400'"
                                        class="text-xs mb-1"
                                        x-text="openCircuits.length > 0 ? openCircuits.length + ' OPEN' : 'All Closed'"></span>
                                </div>
                            </div>

                            <!-- Privacy Budget Card -->
                            <div class="plm-card gradient-card-amber">
                                <span
                                    class="text-[10px] text-white/60 uppercase font-bold tracking-wider mb-1 block">Privacy
                                    Budget</span>
                                <div class="flex items-center gap-3">
                                    <div class="w-12 h-12">
                                        <canvas id="privacyChart"></canvas>
                                    </div>
                                    <div>
                                        <span class="text-xl font-bold font-mono"
                                            x-text="'Îµ ' + ((stats.privacy_cap || 10) - (stats.privacy_consumed || 1.6)).toFixed(1)"></span>
                                        <div class="text-[10px] text-white/40">Remaining</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Keys Status Card -->
                            <div class="plm-card"
                                :class="keysNeedingRotation > 0 ? 'gradient-card-red' : 'gradient-card-green'">
                                <span
                                    class="text-[10px] text-white/60 uppercase font-bold tracking-wider mb-1 block">Key
                                    Status</span>
                                <div class="flex items-end gap-2">
                                    <span class="text-3xl font-bold font-mono" x-text="keys.length"></span>
                                    <span :class="keysNeedingRotation > 0 ? 'text-red-400' : 'text-emerald-400'"
                                        class="text-xs mb-1"
                                        x-text="keysNeedingRotation > 0 ? keysNeedingRotation + ' need rotation' : 'All Current'"></span>
                                    =======
                                    <div class="gh-header">
                                        <h2 class="text-xl font-semibold">System Dashboard</h2>
                                        <span class="text-xs text-[#8b949e]">Enterprise Fleet Overview</span>
                                    </div>

                                    <!-- Pipeline Braid -->
                                    <div class="gh-card mb-6 overflow-hidden relative">
                                        <div
                                            class="absolute inset-0 bg-gradient-to-r from-[#58a6ff]/5 via-transparent to-[#238636]/5 pointer-events-none">
                                        </div>
                                        <h3
                                            class="text-[10px] font-bold uppercase tracking-widest text-[#8b949e] mb-2 flex justify-between">
                                            <span>Unified 7-Stage Pipeline Braid</span>
                                            <span class="text-[#58a6ff] font-mono">LATEST_TRACE: #<span
                                                    x-text="currentTime.substring(17,19)"></span></span>
                                        </h3>
                                        <!-- n8n Style Visualizer -->
                                        <div class="gh-card p-0 overflow-hidden relative"
                                            style="height: 480px; border-top: 3px solid var(--accent-orange);">
                                            <div
                                                class="node-header pl-4 py-2 bg-[#111] border-b border-[#333] flex justify-between items-center">
                                                <span
                                                    class="uppercase tracking-widest text-[10px] font-bold text-[#666]">System
                                                    Topology</span>
                                                <div class="flex gap-2 mr-2">
                                                    <span class="badge badge-info"><i data-lucide="activity"
                                                            class="w-3 h-3 inline mr-1"></i> Live Telemetry</span>
                                                </div>
                                            </div>
                                            <div id="n8n-canvas">
                                                <!-- SVG Layer -->
                                                <svg class="connector-layer">
                                                    <!-- Paths injected by JS -->
                                                </svg>
                                                <!-- HTML Nodes injected by JS -->
                                            </div>
                                        </div>

                                        <div class="pipeline-container">
                                            <!-- Animated SVG Braid -->
                                            <svg class="absolute inset-x-0 top-1/2 -translate-y-1/2 w-full h-8 opacity-20 pointer-events-none"
                                                preserveAspectRatio="none">
                                                <path
                                                    d="M0,15 Q25,0 50,15 T100,15 T150,15 T200,15 T250,15 T300,15 T350,15 T400,15 T450,15 T500,15 T550,15 T600,15 T650,15 T700,15 T750,15 T800,15 T850,15 T900,15 T950,15 T1000,15"
                                                    fill="none" stroke="url(#braidGrad)" stroke-width="2"
                                                    class="braid-path">
                                                    <animate attributeName="stroke-dashoffset" from="1000" to="0"
                                                        dur="10s" repeatCount="indefinite" />
                                                </path>
                                                <defs>
                                                    <linearGradient id="braidGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                                        <stop offset="0%" class="braid-stop-0" />
                                                        <stop offset="100%" class="braid-stop-100" />
                                                    </linearGradient>
                                                </defs>
                                            </svg>

                                            <template x-for="(node, index) in pipelineWorkflow" :key="node.stage">
                                                <div class="pipeline-node group">
                                                    <div class="node-icon"
                                                        :class="node.status === 'ok' ? 'ok' : 'active'">
                                                        <i :data-lucide="
                                            node.stage === 'capture' ? 'camera' :
                                            node.stage === 'embed' ? 'cpu' :
                                            node.stage === 'gate' ? 'git-branch' :
                                            node.stage === 'peft' ? 'zap' :
                                            node.stage === 'shield' ? 'shield-check' :
                                            node.stage === 'sync' ? 'refresh-cw' : 'download-cloud'
                                        " class="w-5 h-5"></i>
                                                        <!-- Particle Emitter for active nodes -->
                                                        <template x-if="node.status !== 'ok'">
                                                            <div
                                                                class="absolute inset-0 animate-ping opacity-20 bg-sky-500 rounded-full">
                                                            </div>
                                                        </template>
                                                    </div>
                                                    <span class="node-label" x-text="node.stage"></span>
                                                    <span class="node-latency animate-pulse-subtle"
                                                        x-text="node.latency_ms + ' ms'"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-4 gap-4 mb-6">
                                        <div class="gh-card">
                                            <span
                                                class="text-[10px] text-[#8b949e] uppercase font-bold tracking-wider mb-1 block">Active
                                                Identifiers</span>
                                            <div class="flex items-end gap-2">
                                                <span class="text-2xl font-bold font-mono"
                                                    x-text="endpoints.length || certificates.length || 14"></span>
                                                <span class="text-[#3fb950] text-[10px] mb-1 flex items-center gap-1">
                                                    <span
                                                        class="w-1.5 h-1.5 rounded-full bg-[#3fb950] animate-pulse"></span>
                                                    Live
                                                </span>
                                            </div>
                                        </div>
                                        <div class="gh-card">
                                            <span
                                                class="text-[10px] text-[#8b949e] uppercase font-bold tracking-wider mb-1 block">Lineage
                                                Score</span>
                                            <div class="flex items-end gap-2">
                                                <span class="text-2xl font-bold font-mono">99.8</span>
                                                <span class="text-[#58a6ff] text-[10px] mb-1">% Auth</span>
                                            </div>
                                        </div>
                                        <div class="gh-card">
                                            <span
                                                class="text-[10px] text-[#8b949e] uppercase font-bold tracking-wider mb-1 block">PQC
                                                Days</span>
                                            <div class="flex items-end gap-2">
                                                <span class="text-2xl font-bold font-mono text-[#d29922]"
                                                    x-text="keyRotation.pqc_days_remaining"></span>
                                                <span class="text-[#8b949e] text-[10px] mb-1">Until Rotation</span>
                                            </div>
                                        </div>
                                        <div class="gh-card">
                                            <span
                                                class="text-[10px] text-[#8b949e] uppercase font-bold tracking-wider mb-1 block">Trust
                                                Health</span>
                                            <div class="flex items-end gap-2">
                                                <span class="text-2xl font-bold font-mono text-[#3fb950]"
                                                    x-text="trustPosture.compliance_health + '%'"></span>
                                                >>>>>>> 5a99ad8 (feat: realign N8n, Eval Arena, and PEFT for Robotics
                                                VLA workflows)
                                            </div>
                                        </div>
                                    </div>

                                    <<<<<<< HEAD <!-- Pipeline Overview Section -->
                                        <div class="grid grid-cols-3 gap-6 mb-8">
                                            <div class="plm-card col-span-2">
                                                <h4
                                                    class="text-sm font-semibold mb-4 flex items-center gap-2 text-white/80">
                                                    <i data-lucide="git-merge" class="w-4 h-4 text-sky-400"></i>
                                                    Data Flow Overview
                                                </h4>
                                                <div class="space-y-4">
                                                    <template x-for="pipeline in pipelines"
                                                        :key="pipeline.pipeline_name">
                                                        <div class="bg-white/5 rounded-lg p-4 border border-white/5">
                                                            <div class="flex justify-between items-center mb-3">
                                                                <span class="font-medium text-sm"
                                                                    x-text="pipeline.pipeline_name.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                                                <span
                                                                    :class="pipeline.status === 'healthy' ? 'text-emerald-400 bg-emerald-500/20' : 'text-red-400 bg-red-500/20'"
                                                                    class="text-[10px] px-2 py-0.5 rounded-full font-bold uppercase"
                                                                    x-text="pipeline.status"></span>
                                                            </div>
                                                            <div class="flex items-center gap-2">
                                                                <template x-for="(stage, idx) in pipeline.stages"
                                                                    :key="stage.name">
                                                                    <div class="flex items-center">
                                                                        <div
                                                                            class="flex flex-col items-center min-w-[80px] bg-black/20 rounded p-2">
                                                                            <span
                                                                                class="text-[9px] text-white/40 truncate w-full text-center"
                                                                                x-text="stage.name"></span>
                                                                            <span class="text-[10px] font-mono"
                                                                                :class="stage.status === 'healthy' ? 'text-emerald-400' : 'text-red-400'"
                                                                                x-text="stage.latency_ms.toFixed(1) + 'ms'"></span>
                                                                        </div>
                                                                        <template
                                                                            x-if="idx < pipeline.stages.length - 1">
                                                                            <i data-lucide="arrow-right"
                                                                                class="w-4 h-4 text-white/20 mx-1"></i>
                                                                        </template>
                                                                    </div>
                                                                </template>
                                                            </div>
                                                            <div
                                                                class="flex justify-between mt-3 text-[10px] text-white/40">
                                                                <span>Total: <span class="text-white/60 font-mono"
                                                                        x-text="pipeline.total_latency_ms.toFixed(1) + 'ms'"></span></span>
                                                                <span>Success: <span class="text-emerald-400 font-mono"
                                                                        x-text="pipeline.success_rate + '%'"></span></span>
                                                                <span>Throughput: <span class="text-sky-400 font-mono"
                                                                        x-text="pipeline.current_throughput.toFixed(0) + '/s'"></span></span>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>

                                            <!-- System Metrics -->
                                            <div class="plm-card">
                                                <h4
                                                    class="text-sm font-semibold mb-4 flex items-center gap-2 text-white/80">
                                                    <i data-lucide="activity" class="w-4 h-4 text-emerald-400"></i>
                                                    System Telemetry
                                                </h4>
                                                <div class="space-y-4">
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-xs text-white/40">CPU Usage</span>
                                                        <div class="flex items-center gap-2">
                                                            <div
                                                                class="w-24 h-2 bg-white/10 rounded-full overflow-hidden">
                                                                <div class="h-full bg-sky-500 transition-all"
                                                                    :style="'width: ' + (systemMetrics.cpu_usage_percent || 0) + '%'">
                                                                </div>
                                                            </div>
                                                            <span
                                                                class="font-mono text-xs text-white/60 w-12 text-right"
                                                                x-text="(systemMetrics.cpu_usage_percent || 0).toFixed(1) + '%'"></span>
                                                        </div>
                                                    </div>
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-xs text-white/40">Memory</span>
                                                        <div class="flex items-center gap-2">
                                                            <div
                                                                class="w-24 h-2 bg-white/10 rounded-full overflow-hidden">
                                                                <div class="h-full bg-violet-500 transition-all"
                                                                    :style="'width: ' + (systemMetrics.memory_usage_percent || 0) + '%'">
                                                                </div>
                                                            </div>
                                                            <span
                                                                class="font-mono text-xs text-white/60 w-12 text-right"
                                                                x-text="(systemMetrics.memory_usage_percent || 0).toFixed(1) + '%'"></span>
                                                        </div>
                                                    </div>
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-xs text-white/40">Disk</span>
                                                        <div class="flex items-center gap-2">
                                                            <div
                                                                class="w-24 h-2 bg-white/10 rounded-full overflow-hidden">
                                                                <div class="h-full bg-amber-500 transition-all"
                                                                    :style="'width: ' + (systemMetrics.disk_usage_percent || 0) + '%'">
                                                                </div>
                                                            </div>
                                                            <span
                                                                class="font-mono text-xs text-white/60 w-12 text-right"
                                                                x-text="(systemMetrics.disk_usage_percent || 0).toFixed(1) + '%'"></span>
                                                        </div>
                                                    </div>
                                                    <div class="border-t border-white/5 pt-4 mt-4">
                                                        <div class="flex justify-between items-center mb-2">
                                                            <span class="text-xs text-white/40">Active Threads</span>
                                                            <span class="font-mono text-sm"
                                                                x-text="systemMetrics.thread_count || '--'"></span>
                                                        </div>
                                                        <div class="flex justify-between items-center mb-2">
                                                            <span class="text-xs text-white/40">Connections</span>
                                                            <span class="font-mono text-sm"
                                                                x-text="systemMetrics.active_connections || '--'"></span>
                                                        </div>
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-xs text-white/40">Network I/O</span>
                                                            <span class="font-mono text-sm text-sky-400"
                                                                x-text="formatBytes(systemMetrics.network_bytes_sent || 0) + ' / ' + formatBytes(systemMetrics.network_bytes_recv || 0)"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Recent Errors & Activity -->
                                        <div class="grid grid-cols-2 gap-6">
                                            <div class="plm-card">
                                                <h4
                                                    class="text-sm font-semibold mb-4 flex items-center justify-between">
                                                    <span class="flex items-center gap-2 text-white/80">
                                                        <i data-lucide="alert-triangle"
                                                            class="w-4 h-4 text-amber-400"></i>
                                                        Recent Errors
                                                    </span>
                                                    <button @click="activeTab = 'errors'"
                                                        class="text-[10px] text-sky-400 hover:text-sky-300">View
                                                        All</button>
                                                </h4>
                                                <div class="space-y-2 max-h-48 overflow-y-auto">
                                                    <template x-for="error in errors.slice(0, 5)"
                                                        :key="error.timestamp">
                                                        <div
                                                            class="flex items-start gap-3 p-2 rounded bg-white/5 hover:bg-white/10 transition-colors">
                                                            <i data-lucide="alert-circle"
                                                                :class="error.level === 'error' ? 'text-red-400' : error.level === 'warning' ? 'text-amber-400' : 'text-sky-400'"
                                                                class="w-4 h-4 flex-shrink-0 mt-0.5"></i>
                                                            <div class="flex-1 min-w-0">
                                                                <div class="flex justify-between items-start">
                                                                    <span class="text-xs font-medium truncate"
                                                                        x-text="error.message"></span>
                                                                    <span
                                                                        class="text-[9px] text-white/30 ml-2 flex-shrink-0"
                                                                        x-text="formatRelativeTime(error.timestamp * 1000)"></span>
                                                                </div>
                                                                <span class="text-[10px] text-white/40"
                                                                    x-text="error.component"></span>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    <template x-if="errors.length === 0">
                                                        <p class="text-center py-4 text-xs text-white/30">No recent
                                                            errors</p>
                                                    </template>
                                                </div>
                                            </div>

                                            <div class="plm-card">
                                                <h4
                                                    class="text-sm font-semibold mb-4 flex items-center justify-between">
                                                    <span class="flex items-center gap-2 text-white/80">
                                                        <i data-lucide="zap" class="w-4 h-4 text-sky-400"></i>
                                                        Circuit Breaker Status
                                                    </span>
                                                </h4>
                                                <div class="space-y-2 max-h-48 overflow-y-auto">
                                                    <template x-for="circuit in circuits" :key="circuit.name">
                                                        <div
                                                            class="flex items-center justify-between p-2 rounded bg-white/5">
                                                            <div class="flex items-center gap-2">
                                                                <span class="w-2 h-2 rounded-full"
                                                                    :class="circuit.state === 'closed' ? 'bg-emerald-500' : circuit.state === 'open' ? 'bg-red-500' : 'bg-amber-500'"></span>
                                                                <span class="text-xs font-mono"
                                                                    x-text="circuit.name"></span>
                                                            </div>
                                                            <div class="flex items-center gap-3">
                                                                <span class="text-[10px] text-white/40"
                                                                    x-text="'Fail: ' + (circuit.failure_rate * 100).toFixed(1) + '%'"></span>
                                                                <span class="text-[10px] px-2 py-0.5 rounded"
                                                                    :class="circuit.state === 'closed' ? 'text-emerald-400 bg-emerald-500/20' : circuit.state === 'open' ? 'text-red-400 bg-red-500/20' : 'text-amber-400 bg-amber-500/20'"
                                                                    x-text="circuit.state.toUpperCase()"></span>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    <template x-if="circuits.length === 0">
                                                        <p class="text-center py-4 text-xs text-white/30">No circuit
                                                            breakers registered</p>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                </div>

                                <!-- Pipeline Monitor Tab -->
                                <div x-show="activeTab === 'pipeline'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="git-merge" class="text-sky-500 w-5 h-5"></i> Pipeline Monitor
                                    </h3>

                                    <div class="space-y-6">
                                        <template x-for="pipeline in pipelines" :key="pipeline.pipeline_name">
                                            <div class="plm-card">
                                                <div class="flex justify-between items-center mb-6">
                                                    <div>
                                                        <h4 class="font-semibold text-lg"
                                                            x-text="pipeline.pipeline_name.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())">
                                                        </h4>
                                                        <p class="text-xs text-white/40">Real-time data flow
                                                            visualization</p>
                                                    </div>
                                                    <div class="flex items-center gap-4">
                                                        <div class="text-right">
                                                            <div class="text-[10px] text-white/40">Total Latency</div>
                                                            <div class="font-mono text-lg text-sky-400"
                                                                x-text="pipeline.total_latency_ms.toFixed(1) + 'ms'">
                                                            </div>
                                                        </div>
                                                        <div class="text-right">
                                                            <div class="text-[10px] text-white/40">Success Rate</div>
                                                            <div class="font-mono text-lg"
                                                                :class="pipeline.success_rate >= 99 ? 'text-emerald-400' : pipeline.success_rate >= 95 ? 'text-amber-400' : 'text-red-400'"
                                                                x-text="pipeline.success_rate + '%'"></div>
                                                        </div>
                                                        <span
                                                            :class="pipeline.status === 'healthy' ? 'text-emerald-400 bg-emerald-500/20 border-emerald-500/30' : 'text-red-400 bg-red-500/20 border-red-500/30'"
                                                            class="text-xs px-3 py-1 rounded-full font-bold uppercase border"
                                                            x-text="pipeline.status"></span>
                                                    </div>
                                                </div>

                                                <!-- Pipeline Stages Visualization -->
                                                <div class="relative">
                                                    <div class="flex items-center justify-between">
                                                        <template x-for="(stage, idx) in pipeline.stages"
                                                            :key="stage.name">
                                                            <div class="flex items-center flex-1">
                                                                <div class="flex-1 flex flex-col items-center">
                                                                    <div :class="stage.status === 'healthy' ? 'border-emerald-500/50 bg-emerald-500/10' : 'border-red-500/50 bg-red-500/10'"
                                                                        class="w-full max-w-[160px] border rounded-lg p-4 relative group hover:scale-105 transition-transform">
                                                                        <div
                                                                            class="absolute -top-2 left-1/2 transform -translate-x-1/2">
                                                                            <span
                                                                                class="w-4 h-4 rounded-full border-2 flex items-center justify-center"
                                                                                :class="stage.status === 'healthy' ? 'border-emerald-500 bg-emerald-500' : 'border-red-500 bg-red-500'">
                                                                                <i data-lucide="check"
                                                                                    class="w-2 h-2 text-white"></i>
                                                                            </span>
                                                                        </div>
                                                                        <div class="text-center mt-2">
                                                                            <div class="font-medium text-sm"
                                                                                x-text="stage.name"></div>
                                                                            <div class="mt-2 space-y-1">
                                                                                <div
                                                                                    class="flex justify-between text-[10px]">
                                                                                    <span
                                                                                        class="text-white/40">Latency</span>
                                                                                    <span class="font-mono text-sky-400"
                                                                                        x-text="stage.latency_ms.toFixed(2) + 'ms'"></span>
                                                                                </div>
                                                                                <div
                                                                                    class="flex justify-between text-[10px]">
                                                                                    <span
                                                                                        class="text-white/40">Throughput</span>
                                                                                    <span
                                                                                        class="font-mono text-violet-400"
                                                                                        x-text="stage.throughput.toFixed(0) + '/s'"></span>
                                                                                </div>
                                                                                <div
                                                                                    class="flex justify-between text-[10px]">
                                                                                    <span
                                                                                        class="text-white/40">Errors</span>
                                                                                    <span class="font-mono"
                                                                                        :class="stage.error_count > 0 ? 'text-red-400' : 'text-white/40'"
                                                                                        x-text="stage.error_count"></span>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <template x-if="idx < pipeline.stages.length - 1">
                                                                    <div
                                                                        class="flex-shrink-0 w-8 flex items-center justify-center">
                                                                        <div
                                                                            class="w-full h-0.5 bg-gradient-to-r from-white/20 to-white/5">
                                                                        </div>
                                                                        <i data-lucide="chevron-right"
                                                                            class="w-4 h-4 text-white/30 absolute"></i>
                                                                    </div>
                                                                </template>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>

                                <!-- Error Console Tab -->
                                <div x-show="activeTab === 'errors'" x-transition x-cloak>
                                    <div class="flex justify-between items-center mb-6">
                                        <h3 class="text-lg font-semibold flex items-center gap-2">
                                            <i data-lucide="alert-circle" class="text-amber-500 w-5 h-5"></i> Error
                                            Console
                                        </h3>
                                        <div class="flex items-center gap-4">
                                            <select x-model="errorFilter.level"
                                                class="bg-white/5 border border-white/10 rounded-lg px-3 py-1.5 text-xs">
                                                <option value="">All Levels</option>
                                                <option value="error">Errors</option>
                                                <option value="warning">Warnings</option>
                                                <option value="info">Info</option>
                                            </select>
                                            <select x-model="errorFilter.component"
                                                class="bg-white/5 border border-white/10 rounded-lg px-3 py-1.5 text-xs">
                                                <option value="">All Components</option>
                                                <option value="aggregator">Aggregator</option>
                                                <option value="crypto">Crypto</option>
                                                <option value="identity">Identity</option>
                                                <option value="pipeline">Pipeline</option>
                                                <option value="network">Network</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Error Summary Cards -->
                                    <div class="grid grid-cols-4 gap-4 mb-6">
                                        <div class="plm-card bg-red-500/5 border-red-500/20">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center">
                                                    <i data-lucide="x-circle" class="w-5 h-5 text-red-400"></i>
                                                </div>
                                                <div>
                                                    <div class="text-2xl font-bold font-mono text-red-400"
                                                        x-text="errorSummary.by_level?.error || 0"></div>
                                                    <div class="text-[10px] text-white/40 uppercase">Errors</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="plm-card bg-amber-500/5 border-amber-500/20">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                                                    <i data-lucide="alert-triangle" class="w-5 h-5 text-amber-400"></i>
                                                </div>
                                                <div>
                                                    <div class="text-2xl font-bold font-mono text-amber-400"
                                                        x-text="errorSummary.by_level?.warning || 0"></div>
                                                    <div class="text-[10px] text-white/40 uppercase">Warnings</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="plm-card bg-sky-500/5 border-sky-500/20">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 rounded-lg bg-sky-500/20 flex items-center justify-center">
                                                    <i data-lucide="info" class="w-5 h-5 text-sky-400"></i>
                                                </div>
                                                <div>
                                                    <div class="text-2xl font-bold font-mono text-sky-400"
                                                        x-text="errorSummary.by_level?.info || 0"></div>
                                                    <div class="text-[10px] text-white/40 uppercase">Info</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center">
                                                    <i data-lucide="clock" class="w-5 h-5 text-white/60"></i>
                                                </div>
                                                <div>
                                                    <div class="text-2xl font-bold font-mono"
                                                        x-text="errorSummary.total_24h || 0"></div>
                                                    <div class="text-[10px] text-white/40 uppercase">Last 24h</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Error Log Table -->
                                    <div class="plm-card">
                                        <table class="w-full text-left text-sm">
                                            <thead>
                                                <tr class="text-white/40 border-b border-white/5">
                                                    <th class="pb-3 font-medium w-32">Time</th>
                                                    <th class="pb-3 font-medium w-20">Level</th>
                                                    <th class="pb-3 font-medium w-28">Component</th>
                                                    <th class="pb-3 font-medium">Message</th>
                                                    <th class="pb-3 font-medium w-28">Trace ID</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-white/5">
                                                <template x-for="error in filteredErrors"
                                                    :key="error.timestamp + error.trace_id">
                                                    <tr class="hover:bg-white/[0.02] transition-all cursor-pointer"
                                                        @click="selectedError = error">
                                                        <td class="py-3 text-xs text-white/40"
                                                            x-text="formatTimestamp(error.timestamp)"></td>
                                                        <td class="py-3">
                                                            <span
                                                                :class="error.level === 'error' ? 'text-red-400 bg-red-500/20' : error.level === 'warning' ? 'text-amber-400 bg-amber-500/20' : 'text-sky-400 bg-sky-500/20'"
                                                                class="text-[10px] px-2 py-0.5 rounded-full font-bold uppercase"
                                                                x-text="error.level"></span>
                                                        </td>
                                                        <td class="py-3 text-xs font-mono text-white/60"
                                                            x-text="error.component"></td>
                                                        <td class="py-3 text-xs truncate max-w-[300px]"
                                                            x-text="error.message"></td>
                                                        <td class="py-3 text-[10px] font-mono text-sky-400"
                                                            x-text="error.trace_id || '-'"></td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Key Management Tab -->
                                <div x-show="activeTab === 'keys'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="key" class="text-sky-500 w-5 h-5"></i> Cryptographic Key
                                        Management
                                    </h3>

                                    <!-- Key Status Overview -->
                                    <div class="grid grid-cols-4 gap-4 mb-6">
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Total Keys</div>
                                            <div class="text-2xl font-bold font-mono" x-text="keys.length"></div>
                                        </div>
                                        <div class="plm-card"
                                            :class="keysNeedingRotation > 0 ? 'border-amber-500/30' : ''">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Rotation Due</div>
                                            <div class="text-2xl font-bold font-mono"
                                                :class="keysNeedingRotation > 0 ? 'text-amber-400' : ''"
                                                x-text="keysNeedingRotation"></div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Aggregation Keys</div>
                                            <div class="text-2xl font-bold font-mono"
                                                x-text="keys.filter(k => k.scope === 'aggregation').length"></div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Identity Keys</div>
                                            <div class="text-2xl font-bold font-mono"
                                                x-text="keys.filter(k => k.scope === 'identity').length"></div>
                                        </div>
                                    </div>

                                    <!-- Key Table -->
                                    <div class="plm-card">
                                        <table class="w-full text-left text-sm">
                                            <thead>
                                                <tr class="text-white/40 border-b border-white/5">
                                                    <th class="pb-3 font-medium">Key ID</th>
                                                    <th class="pb-3 font-medium">Scope</th>
                                                    <th class="pb-3 font-medium">Algorithm</th>
                                                    <th class="pb-3 font-medium">Uses Remaining</th>
                                                    <th class="pb-3 font-medium">Next Rotation</th>
                                                    <th class="pb-3 font-medium">Status</th>
                                                    <th class="pb-3 font-medium">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-white/5">
                                                <template x-for="key in keys" :key="key.key_id">
                                                    <tr class="hover:bg-white/[0.02] transition-all">
                                                        <td class="py-4 font-mono text-xs text-sky-400"
                                                            x-text="key.key_id"></td>
                                                        <td class="py-4">
                                                            <span class="text-xs px-2 py-0.5 rounded bg-white/10"
                                                                x-text="key.scope"></span>
                                                        </td>
                                                        <td class="py-4 text-xs font-mono text-white/60"
                                                            x-text="key.algorithm"></td>
                                                        <td class="py-4">
                                                            <div class="flex items-center gap-2">
                                                                <div
                                                                    class="w-16 h-1.5 bg-white/10 rounded-full overflow-hidden">
                                                                    <div class="h-full transition-all"
                                                                        :class="key.uses_remaining < 300 ? 'bg-red-500' : key.uses_remaining < 700 ? 'bg-amber-500' : 'bg-emerald-500'"
                                                                        :style="'width: ' + (key.uses_remaining / 10) + '%'">
                                                                    </div>
                                                                </div>
                                                                <span class="text-xs font-mono"
                                                                    x-text="key.uses_remaining"></span>
                                                            </div>
                                                        </td>
                                                        <td class="py-4 text-xs text-white/40"
                                                            x-text="key.next_rotation_at ? formatTimestamp(key.next_rotation_at) : 'N/A'">
                                                        </td>
                                                        <td class="py-4">
                                                            <span
                                                                :class="key.rotation_due ? 'text-amber-400 bg-amber-500/20' : 'text-emerald-400 bg-emerald-500/20'"
                                                                class="text-[10px] px-2 py-0.5 rounded-full font-bold uppercase"
                                                                x-text="key.rotation_due ? 'ROTATION DUE' : 'CURRENT'"></span>
                                                        </td>
                                                        <td class="py-4">
                                                            <button @click="rotateKey(key.key_id)"
                                                                class="text-xs px-3 py-1 rounded bg-sky-600 hover:bg-sky-500 transition-colors">
                                                                Rotate
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Configuration Tab -->
                                <div x-show="activeTab === 'config'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="settings" class="text-sky-500 w-5 h-5"></i> System Configuration
                                    </h3>

                                    <div class="grid grid-cols-3 gap-6">
                                        <!-- Identity Subsystem -->
                                        <div class="plm-card">
                                            <h4 class="font-semibold mb-4 flex items-center gap-2">
                                                <i data-lucide="fingerprint" class="w-4 h-4 text-violet-400"></i>
                                                Identity Management
                                            </h4>
                                            <div class="space-y-4">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Subsystem</span>
                                                    <span
                                                        class="text-xs px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400">ENABLED</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Key Type</span>
                                                    <span class="text-xs font-mono">ECDSA</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Scan Interval</span>
                                                    <span class="text-xs font-mono">3600s</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Auto Renew</span>
                                                    <span
                                                        class="text-xs px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400">ON</span>
                                                </div>
                                                <div class="border-t border-white/5 pt-3 mt-3">
                                                    <div class="text-[10px] text-white/40 mb-2">Active Scanners</div>
                                                    <div class="flex flex-wrap gap-1">
                                                        <span
                                                            class="text-[9px] px-1.5 py-0.5 rounded bg-white/10">Kubernetes</span>
                                                        <span
                                                            class="text-[9px] px-1.5 py-0.5 rounded bg-white/10">Nginx</span>
                                                        <span
                                                            class="text-[9px] px-1.5 py-0.5 rounded bg-white/10">Filesystem</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Network Subsystem -->
                                        <div class="plm-card">
                                            <h4 class="font-semibold mb-4 flex items-center gap-2">
                                                <i data-lucide="shield" class="w-4 h-4 text-sky-400"></i>
                                                Network Traffic Privacy
                                            </h4>
                                            <div class="space-y-4">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Subsystem</span>
                                                    <span
                                                        class="text-xs px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400">ENABLED</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Defense Mode</span>
                                                    <span class="text-xs font-mono text-sky-400">FRONT</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Proxy Port</span>
                                                    <span class="text-xs font-mono">9000</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Padding Size</span>
                                                    <span class="text-xs font-mono">800 bytes</span>
                                                </div>
                                                <div class="border-t border-white/5 pt-3 mt-3">
                                                    <div class="text-[10px] text-white/40 mb-2">Active Defenses</div>
                                                    <div class="flex flex-wrap gap-1">
                                                        <span
                                                            class="text-[9px] px-1.5 py-0.5 rounded bg-sky-500/20 text-sky-400">FRONT</span>
                                                        <span
                                                            class="text-[9px] px-1.5 py-0.5 rounded bg-white/10">WTF-PAD
                                                            Ready</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ML Subsystem -->
                                        <div class="plm-card">
                                            <h4 class="font-semibold mb-4 flex items-center gap-2">
                                                <i data-lucide="brain" class="w-4 h-4 text-emerald-400"></i>
                                                Federated Learning
                                            </h4>
                                            <div class="space-y-4">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Subsystem</span>
                                                    <span
                                                        class="text-xs px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400">ENABLED</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Model Type</span>
                                                    <span class="text-xs font-mono">PI0</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">Security Level</span>
                                                    <span
                                                        class="text-xs px-2 py-0.5 rounded bg-sky-500/20 text-sky-400">HIGH
                                                        (FHE+DP)</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-xs text-white/60">DP Epsilon</span>
                                                    <span class="text-xs font-mono">3.0</span>
                                                </div>
                                                <div class="border-t border-white/5 pt-3 mt-3">
                                                    <div class="text-[10px] text-white/40 mb-2">Pipeline Config</div>
                                                    <div class="grid grid-cols-2 gap-2 text-[10px]">
                                                        <div class="flex justify-between">
                                                            <span class="text-white/40">Max Norm</span>
                                                            <span class="font-mono">1.0</span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-white/40">Sparsity</span>
                                                            <span class="font-mono">0.5</span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-white/40">Compression</span>
                                                            <span class="font-mono">32x</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Degradation Status -->
                                    <div class="plm-card mt-6">
                                        <h4 class="font-semibold mb-4 flex items-center gap-2">
                                            <i data-lucide="gauge" class="w-4 h-4 text-amber-400"></i>
                                            Graceful Degradation Status
                                        </h4>
                                        <div class="grid grid-cols-4 gap-4">
                                            <div>
                                                <div class="text-[10px] text-white/40 mb-1">Current Level</div>
                                                <span
                                                    :class="degradation.level === 'normal' ? 'text-emerald-400' : degradation.level === 'light' ? 'text-sky-400' : degradation.level === 'moderate' ? 'text-amber-400' : 'text-red-400'"
                                                    class="font-mono text-lg font-bold uppercase"
                                                    x-text="degradation.level"></span>
                                            </div>
                                            <div>
                                                <div class="text-[10px] text-white/40 mb-1">Reason</div>
                                                <span class="text-sm" x-text="degradation.reason"></span>
                                            </div>
                                            <div>
                                                <div class="text-[10px] text-white/40 mb-1">Enabled Features</div>
                                                <span class="text-sm font-mono"
                                                    x-text="degradation.enabled_features?.length || 0"></span>
                                            </div>
                                            <div>
                                                <div class="text-[10px] text-white/40 mb-1">Disabled Features</div>
                                                <span class="text-sm font-mono"
                                                    :class="degradation.disabled_features?.length > 0 ? 'text-amber-400' : ''"
                                                    x-text="degradation.disabled_features?.length || 0"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Version Control Tab -->
                                <div x-show="activeTab === 'versions'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="history" class="text-sky-500 w-5 h-5"></i> Version Control &
                                        Lineage
                                    </h3>

                                    <!-- Version Info -->
                                    <div class="grid grid-cols-4 gap-4 mb-6">
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">System Version</div>
                                            <div class="text-xl font-bold font-mono"
                                                x-text="versionInfo.system_version || '--'"></div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">API Version</div>
                                            <div class="text-xl font-bold font-mono"
                                                x-text="versionInfo.api_version || '--'"></div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Git Commit</div>
                                            <div class="text-xl font-bold font-mono text-sky-400"
                                                x-text="versionInfo.git_commit || '--'"></div>
                                        </div>
                                        <div class="plm-card">
                                            <div class="text-[10px] text-white/40 uppercase mb-1">Current Model</div>
                                            <div class="text-xl font-bold font-mono text-emerald-400"
                                                x-text="modelLineage.current_version || '--'"></div>
                                        </div>
                                    </div>

                                    <!-- Component Versions -->
                                    <div class="plm-card mb-6">
                                        <h4 class="font-semibold mb-4">Component Versions</h4>
                                        <div class="grid grid-cols-5 gap-4">
                                            <template x-for="(version, component) in (versionInfo.components || {})"
                                                :key="component">
                                                <div class="bg-white/5 rounded-lg p-3 text-center">
                                                    <div class="text-[10px] text-white/40 uppercase mb-1"
                                                        x-text="component"></div>
                                                    <div class="font-mono text-sm" x-text="version"></div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- Model Lineage -->
                                    <div class="plm-card">
                                        <h4 class="font-semibold mb-4 flex items-center gap-2">
                                            <i data-lucide="git-branch" class="w-4 h-4 text-violet-400"></i>
                                            Model Version Lineage
                                        </h4>
                                        <div class="relative">
                                            <div class="absolute left-4 top-0 bottom-0 w-0.5 bg-white/10"></div>
                                            <div class="space-y-4">
                                                <template x-for="(version, idx) in (modelLineage.lineage || [])"
                                                    :key="version.version">
                                                    <div class="relative pl-10">
                                                        <div class="absolute left-2.5 w-3 h-3 rounded-full border-2 bg-[#0a0a0f]"
                                                            :class="idx === 0 ? 'border-emerald-500' : 'border-white/30'">
                                                        </div>
                                                        <div
                                                            class="bg-white/5 rounded-lg p-4 hover:bg-white/10 transition-colors">
                                                            <div class="flex justify-between items-start mb-2">
                                                                <div>
                                                                    <span class="font-mono text-sm"
                                                                        :class="idx === 0 ? 'text-emerald-400' : ''"
                                                                        x-text="version.version"></span>
                                                                    <span class="text-xs text-white/30 ml-2"
                                                                        x-text="'from ' + version.parent"></span>
                                                                </div>
                                                                <span class="text-[10px] text-white/40"
                                                                    x-text="formatTimestamp(version.created_at)"></span>
                                                            </div>
                                                            <div class="grid grid-cols-3 gap-4 text-[11px]">
                                                                <div>
                                                                    <span class="text-white/40">Clients:</span>
                                                                    <span class="ml-1 font-mono"
                                                                        x-text="version.clients_contributed"></span>
                                                                </div>
                                                                <div>
                                                                    <span class="text-white/40">Privacy Îµ:</span>
                                                                    <span class="ml-1 font-mono text-amber-400"
                                                                        x-text="version.privacy_budget_used?.toFixed(2)"></span>
                                                                </div>
                                                                <div>
                                                                    <span class="text-white/40">Score:</span>
                                                                    <span class="ml-1 font-mono text-emerald-400"
                                                                        x-text="(version.validation_score * 100).toFixed(1) + '%'"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Lineage Tab (Training Runs) -->
                                <div x-show="activeTab === 'lineage'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="git-branch" class="text-sky-500 w-5 h-5"></i> Model Lineage &
                                        Training Runs
                                    </h3>

                                    <div class="plm-card">
                                        <template x-if="loading.runs">
                                            <div class="space-y-4">
                                                <template x-for="i in 5">
                                                    <div class="flex items-center gap-4">
                                                        <div class="skeleton h-4 w-24"></div>
                                                        <div class="skeleton h-4 w-32"></div>
                                                        <div class="skeleton h-4 w-20"></div>
                                                        <div class="skeleton h-4 w-32"></div>
                                                        <div class="skeleton h-4 w-16"></div>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>

                                        <template x-if="!loading.runs && runs.length === 0">
                                            <div class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center mb-4">
                                                    <i data-lucide="git-branch" class="w-6 h-6 text-white/20"></i>
                                                </div>
                                                <p class="text-white/40 text-sm">No runs recorded</p>
                                            </div>
                                        </template>

                                        <template x-if="!loading.runs && runs.length > 0">
                                            <table class="w-full text-left text-sm">
                                                <thead>
                                                    <tr class="text-white/40 border-b border-white/5">
                                                        <th class="pb-3 font-medium">Run ID</th>
                                                        <th class="pb-3 font-medium">Git Commit</th>
                                                        <th class="pb-3 font-medium">SDK Version</th>
                                                        <th class="pb-3 font-medium">Created At</th>
                                                        <th class="pb-3 font-medium">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-white/5">
                                                    <template x-for="run in runs" :key="run.run_id">
                                                        <tr class="hover:bg-white/[0.02] transition-all">
                                                            <td class="py-4 font-mono text-xs text-white/80"
                                                                x-text="run.run_id?.substring(0,8)"></td>
                                                            <td class="py-4 font-mono text-xs text-sky-400"
                                                                x-text="run.git_commit ? run.git_commit.substring(0,7) : '-'">
                                                            </td>
                                                            <td class="py-4 text-xs font-mono text-white/60"
                                                                x-text="run.sdk_version">
                                                            </td>
                                                            <td class="py-4 text-white/40 text-xs"
                                                                x-text="formatDate(run.created_at)">
                                                            </td>
                                                            <td class="py-4">
                                                                <span
                                                                    :class="getStatusBg(run.status) + ' ' + getStatusColor(run.status)"
                                                                    class="px-2 py-1 rounded-full text-[10px] font-medium"
                                                                    x-text="run.status"></span>
                                                            </td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </template>
                                    </div>
                                </div>

                                <!-- Identity Vault Tab -->
                                <div x-show="activeTab === 'vault'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="shield" class="text-sky-500 w-5 h-5"></i> Machine Identity Vault
                                    </h3>

                                    <div class="plm-card">
                                        <template x-if="loading.inventory">
                                            <div class="space-y-4">
                                                <template x-for="i in 5">
                                                    <div class="flex items-center gap-4">
                                                        <div class="skeleton h-4 w-40"></div>
                                                        <div class="skeleton h-4 w-32"></div>
                                                        <div class="skeleton h-4 w-32"></div>
                                                        <div class="skeleton h-4 w-24"></div>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>

                                        <template x-if="!loading.inventory && certificates.length === 0">
                                            <div class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center mb-4">
                                                    <i data-lucide="key" class="w-6 h-6 text-white/20"></i>
                                                </div>
                                                <p class="text-white/40 text-sm">Vault empty</p>
                                            </div>
                                        </template>

                                        <template x-if="!loading.inventory && certificates.length > 0">
                                            <table class="w-full text-left text-sm">
                                                <thead>
                                                    <tr class="text-white/40 border-b border-white/5">
                                                        <th class="pb-3 font-medium">Subject DN</th>
                                                        <th class="pb-3 font-medium">Issuer</th>
                                                        <th class="pb-3 font-medium">Conf</th>
                                                        <th class="pb-3 font-medium">Expires</th>
                                                        <th class="pb-3 font-medium">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-white/5">
                                                    <template x-for="cert in certificates" :key="cert.id">
                                                        <tr class="hover:bg-white/[0.02] transition-all">
                                                            <td class="py-4 text-xs font-mono text-white/80"
                                                                x-text="cert.subject"></td>
                                                            <td class="py-4 text-xs text-white/50" x-text="cert.issuer">
                                                            </td>
                                                            <td class="py-4">
                                                                <template x-if="cert.has_eku_conflict">
                                                                    <i data-lucide="alert-triangle"
                                                                        class="w-4 h-4 text-red-400"></i>
                                                                </template>
                                                                <template x-if="!cert.has_eku_conflict">
                                                                    <i data-lucide="check"
                                                                        class="text-emerald-400/30 w-4 h-4"></i>
                                                                </template>
                                                            </td>
                                                            <td class="py-4 text-xs text-white/50"
                                                                x-text="new Date(cert.not_after).toLocaleDateString()">
                                                            </td>
                                                            <td class="py-4">
                                                                <span :class="getCertExpiryClass(cert.days_to_expiry)"
                                                                    class="px-2 py-1 rounded-full text-[10px] font-bold"
                                                                    x-text="cert.days_to_expiry + ' days'"></span>
                                                            </td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </template>
                                    </div>
                                </div>

                                <!-- Compliance Tab -->
                                <div x-show="activeTab === 'compliance'" x-transition x-cloak>
                                    <div class="flex justify-between items-center mb-6">
                                        <h3 class="text-lg font-semibold">Enterprise Compliance Registry</h3>
                                        =======
                                        <div class="gh-card">
                                            <h4 class="text-sm font-semibold mb-4 flex items-center gap-2">
                                                <i data-lucide="activity" class="text-[#58a6ff] w-4 h-4"></i> System
                                                Activity Proof
                                            </h4>
                                            <table class="w-full text-left text-xs">
                                                <thead>
                                                    <tr class="text-[#8b949e] border-b border-[#30363d]">
                                                        <th class="pb-2">Trace ID</th>
                                                        <th class="pb-2">Type</th>
                                                        <th class="pb-2">Time</th>
                                                        <th class="pb-2">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-[#30363d]">
                                                    <template x-for="job in jobs.slice(0, 5)" :key="job.id">
                                                        <tr class="hover:bg-[#161b22]">
                                                            <td class="py-2 font-mono text-[#58a6ff]"
                                                                x-text="job.id.substring(0,8)"></td>
                                                            <td class="py-2" x-text="job.type"></td>
                                                            <td class="py-2 text-[#8b949e]"
                                                                x-text="formatRelativeTime(job.created_at)">
                                                            </td>
                                                            <td class="py-2">
                                                                <span :class="getStatusColor(job.status)"
                                                                    class="font-bold" x-text="job.status"></span>
                                                            </td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- PEFT Studio Tab -->
                                    <div x-show="activeTab === 'peft-studio'" x-transition x-cloak>
                                        <div class="gh-header">
                                            <div class="flex items-center gap-2">
                                                <h2 class="text-xl font-semibold">PEFT Studio</h2>
                                                <span class="badge badge-warning">BETA</span>
                                            </div>
                                            >>>>>>> 5a99ad8 (feat: realign N8n, Eval Arena, and PEFT for Robotics VLA
                                            workflows)
                                            <div class="flex gap-2">
                                                <button @click="peftStudio.actions.applyProfile('local-hf')"
                                                    class="btn">
                                                    <i data-lucide="file-json" class="w-4 h-4"></i> Local HF Profile
                                                </button>
                                                <button @click="peftStudio.actions.startRun()" class="btn btn-primary"
                                                    :disabled="peftStudio.step < 7">
                                                    <i data-lucide="play" class="w-4 h-4"></i> Start Run
                                                </button>
                                            </div>
                                        </div>

                                        <<<<<<< HEAD <div class="grid grid-cols-2 gap-6 mb-10">
                                            <div
                                                class="plm-card border-emerald-500/20 hover:border-emerald-500/40 transition-all">
                                                <h4 class="font-bold flex items-center gap-2 mb-4">
                                                    <i data-lucide="check-circle" class="text-emerald-500 w-4 h-4"></i>
                                                    SOC 2 Type II
                                                </h4>
                                                <p class="text-xs text-white/50 leading-relaxed mb-4">Verification logs
                                                    synchronized with
                                                    UKF Audit Ledger. Total controls mapped: 24/24.</p>
                                                <div
                                                    class="flex justify-between items-center bg-white/5 p-3 rounded-lg border border-white/5">
                                                    <span class="text-[10px] font-mono text-white/40 uppercase">Last
                                                        Verification</span>
                                                    <span
                                                        class="text-xs font-semibold uppercase text-emerald-400 flex items-center gap-2">
                                                        <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
                                                        PASSED
                                                    </span>
                                                </div>
                                            </div>
                                            <div
                                                class="plm-card border-emerald-500/20 hover:border-emerald-500/40 transition-all">
                                                <h4 class="font-bold flex items-center gap-2 mb-4">
                                                    <i data-lucide="shield" class="text-emerald-500 w-4 h-4"></i> TGSP
                                                    Manifest Integrity
                                                </h4>
                                                <p class="text-xs text-white/50 leading-relaxed mb-4">Cryptographic
                                                    pinning of container
                                                    layers active. All manifests verified against fleet CA.</p>
                                                <div
                                                    class="flex justify-between items-center bg-white/5 p-3 rounded-lg border border-white/5">
                                                    <span class="text-[10px] font-mono text-white/40 uppercase">Active
                                                        Profiles</span>
                                                    <span
                                                        class="text-xs font-semibold uppercase text-emerald-400 flex items-center gap-2">
                                                        <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
                                                        <span
                                                            x-text="tgspPackages.filter(p => p.status === 'verified').length"></span>
                                                        Verified
                                                    </span>
                                                </div>
                                            </div>
                                    </div>

                                    <h4 class="text-sm font-semibold mb-4 flex items-center gap-2 text-white/80">
                                        <i data-lucide="package" class="w-4 h-4 text-sky-400"></i> Security Profiles
                                        (TGSP)
                                    </h4>

                                    <div class="plm-card">
                                        <template x-if="!loading.tgsp && tgspPackages.length > 0">
                                            <table class="w-full text-left text-sm">
                                                <thead>
                                                    <tr class="text-white/40 border-b border-white/5">
                                                        <th class="pb-3 font-medium">Package ID</th>
                                                        <th class="pb-3 font-medium">Producer</th>
                                                        <th class="pb-3 font-medium">Policy Match</th>
                                                        <th class="pb-3 font-medium">Verified On</th>
                                                        <th class="pb-3 font-medium">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-white/5">
                                                    <template x-for="pkg in tgspPackages" :key="pkg.id">
                                                        <tr class="hover:bg-white/[0.02] transition-all">
                                                            <td class="py-4 font-mono text-xs text-white/80"
                                                                x-text="pkg.id?.substring(0,12)"></td>
                                                            <td class="py-4 text-xs text-white/60"
                                                                x-text="pkg.producer_id"></td>
                                                            <td class="py-4">
                                                                <div class="flex flex-col">
                                                                    <span class="text-xs font-medium text-sky-400"
                                                                        x-text="pkg.policy_id"></span>
                                                                    <span class="text-[10px] font-mono text-white/30"
                                                                        x-text="'v' + pkg.policy_version"></span>
                                                                </div>
                                                            </td>
                                                            <td class="py-4 text-white/40 text-xs"
                                                                x-text="new Date(pkg.created_at).toLocaleDateString()">
                                                            </td>
                                                            <td class="py-4">
                                                                <span
                                                                    :class="getStatusBg(pkg.status) + ' ' + getStatusColor(pkg.status)"
                                                                    class="px-2 py-1 rounded-full text-[10px] font-medium"
                                                                    x-text="pkg.status"></span>
                                                            </td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </template>
                                    </div>
                                </div>

                                <!-- Audit Trail Tab -->
                                <div x-show="activeTab === 'audit'" x-transition x-cloak>
                                    <h3 class="text-lg font-semibold mb-6 flex items-center gap-2">
                                        <i data-lucide="clipboard-list" class="text-sky-500 w-5 h-5"></i> Tamper-Proof
                                        Audit Trail
                                    </h3>

                                    <div class="plm-card">
                                        <template x-if="loading.audit">
                                            <div class="space-y-4">
                                                <template x-for="i in 8">
                                                    <div class="flex items-center gap-4">
                                                        <div class="skeleton h-4 w-32"></div>
                                                        <div class="skeleton h-4 w-24"></div>
                                                        <div class="skeleton h-4 w-20"></div>
                                                        <div class="skeleton h-4 w-40"></div>
                                                        <div class="skeleton h-4 w-16"></div>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>

                                        <template x-if="!loading.audit && auditLogs.length === 0">
                                            <div class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center mb-4">
                                                    <i data-lucide="clipboard-list" class="w-6 h-6 text-white/20"></i>
                                                </div>
                                                <p class="text-white/40 text-sm">Audit trail empty</p>
                                            </div>
                                        </template>

                                        <template x-if="!loading.audit && auditLogs.length > 0">
                                            <table class="w-full text-left text-sm">
                                                <thead>
                                                    <tr class="text-white/40 border-b border-white/5">
                                                        <th class="pb-3 font-medium">Timestamp</th>
                                                        <th class="pb-3 font-medium">Actor</th>
                                                        <th class="pb-3 font-medium">Action</th>
                                                        <th class="pb-3 font-medium">Target</th>
                                                        <th class="pb-3 font-medium">Hash</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-white/5">
                                                    <template x-for="log in auditLogs" :key="log.id">
                                                        <tr class="hover:bg-white/[0.02] transition-all">
                                                            <td class="py-4 text-xs text-white/40"
                                                                x-text="formatDate(log.timestamp)">
                                                            </td>
                                                            <td class="py-4">
                                                                <div class="flex flex-col">
                                                                    <span class="text-xs font-bold text-sky-400"
                                                                        x-text="log.actor_type"></span>
                                                                    <span
                                                                        class="text-[10px] text-white/30 truncate max-w-[100px] font-mono"
                                                                        x-text="log.actor_id"></span>
                                                                </div>
                                                            </td>
                                                            <td class="py-4">
                                                                <span class="badge badge-info"
                                                                    x-text="log.action"></span>
                                                            </td>
                                                            <td class="py-4 text-xs font-mono text-white/60"
                                                                x-text="log.target_type + ':' + log.target_id"></td>
                                                            <td class="py-4 text-[10px] font-mono text-white/20 truncate max-w-[80px]"
                                                                x-text="log.entry_hash"></td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </template>
                                    </div>
                                </div>
            </main>
            =======
            <!-- New Grid Layout for PEFT Wizard -->
            <div class="peft-grid">
                <!-- Left: Sidebar Stepper -->
                <div class="gh-card p-0 stepper-vertical h-full">
                    <template
                        x-for="(label, idx) in ['Backend', 'Model', 'Dataset', 'Hyperparams', 'Integrations', 'Review', 'Launch']">
                        <div class="step-item"
                            :class="{'active': peftStudio.step === (idx + 1), 'completed': peftStudio.step > (idx + 1)}"
                            @click="peftStudio.step = (idx + 1)">
                            <div class="flex items-center gap-3">
                                <div class="w-5 h-5 flex items-center justify-center rounded-sm text-[10px] border border-[#333]"
                                    :class="peftStudio.step > (idx + 1) ? 'bg-white text-black border-white' : 'text-[#666]'">
                                    <span x-text="idx + 1"></span>
                                </div>
                                <span x-text="label"></span>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Right: Wizard Content -->
                <div class="wizard-content">
                    <!-- Step 1: Backend -->
                    <div x-show="peftStudio.step === 1" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Choose Training
                            Backend</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="gh-card hover:border-orange cursor-pointer transition-all"
                                :class="{'border-orange': peftStudio.draft.training_config.backend === 'hf'}"
                                @click="peftStudio.draft.training_config.backend = 'hf'">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="font-bold flex items-center gap-2"><i data-lucide="cpu"
                                            class="w-4 h-4"></i> HF Transformers</span>
                                    <span class="badge badge-success">INSTALLED</span>
                                </div>
                                <p class="text-xs text-[#666]">Native LoRA/QLoRA support.</p>
                            </div>
                            <div class="gh-card opacity-50 cursor-not-allowed">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="font-bold flex items-center gap-2"><i data-lucide="box"
                                            class="w-4 h-4"></i> Axolotl</span>
                                    <span class="badge badge-warning">MISSING</span>
                                </div>
                                <p class="text-xs text-[#666]">Config-driven training.</p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <label class="text-xs font-semibold uppercase text-[#666] mb-1 block">Method</label>
                            <select x-model="peftStudio.draft.training_config.method"
                                class="w-full bg-[#111] border border-[#333] p-2 text-white">
                                <option value="lora">LoRA (Ranked Adaptation)</option>
                                <option value="qlora">QLoRA (4-bit Quantized)</option>
                            </select>
                        </div>
                    </div>
                    <!-- Step 2: Model Source -->
                    <div x-show="peftStudio.step === 2" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Model Source</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="text-xs font-semibold text-[#666]">HuggingFace Hub ID</label>
                                <input type="text" x-model="peftStudio.draft.training_config.model_name_or_path"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1"
                                    placeholder="e.g. meta-llama/Llama-2-7b-hf">
                            </div>
                            <button class="btn" @click="peftStudio.actions.testConnector('training_hf')">
                                <i data-lucide="wifi" class="w-4 h-4"></i> Test Connectivity
                            </button>
                        </div>
                    </div>
                    <!-- Step 3: Dataset Source -->
                    <div x-show="peftStudio.step === 3" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Dataset Source</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="text-xs font-semibold text-[#666]">HF Dataset ID</label>
                                <input type="text" x-model="peftStudio.draft.training_config.dataset_name_or_path"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1"
                                    placeholder="e.g. databricks/databricks-dolly-15k">
                            </div>
                            <div class="flex gap-4">
                                <label class="flex items-center gap-2 text-xs text-[#888]">
                                    <input type="checkbox" checked class="accent-[#ff5722]"> Tokenize on-the-fly
                                </label>
                                <label class="flex items-center gap-2 text-xs text-[#888]">
                                    <input type="checkbox" class="accent-[#ff5722]"> Packing
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Hyperparameters -->
                    <div x-show="peftStudio.step === 4" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Hyperparameters</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-semibold text-[#666]">Learning Rate</label>
                                <input type="number" x-model="peftStudio.draft.training_config.learning_rate"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1"
                                    placeholder="5e-5">
                            </div>
                            <div>
                                <label class="text-xs font-semibold text-[#666]">Batch Size</label>
                                <input type="number" x-model="peftStudio.draft.training_config.batch_size"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1" placeholder="4">
                            </div>
                            <div>
                                <label class="text-xs font-semibold text-[#666]">Max Steps</label>
                                <input type="number" x-model="peftStudio.draft.training_config.max_steps"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1" placeholder="100">
                            </div>
                            <div>
                                <label class="text-xs font-semibold text-[#666]">Seed</label>
                                <input type="number" x-model="peftStudio.draft.training_config.seed"
                                    class="w-full bg-[#111] border border-[#333] p-2 text-white mt-1" placeholder="42">
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Integrations -->
                    <div x-show="peftStudio.step === 5" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Integrations</h3>
                        <div class="grid grid-cols-1 gap-2">
                            <div
                                class="gh-card p-3 flex justify-between items-center hover:border-orange cursor-pointer transition-all">
                                <div><span class="font-bold">MLflow</span>
                                    <p class="text-xs text-[#666]">Log metrics</p>
                                </div>
                                <button class="btn btn-sm"><i data-lucide="settings" class="w-3 h-3"></i></button>
                            </div>
                            <div
                                class="gh-card p-3 flex justify-between items-center hover:border-orange cursor-pointer transition-all">
                                <div><span class="font-bold">W&B</span>
                                    <p class="text-xs text-[#666]">Experiment tracking</p>
                                </div>
                                <button class="btn btn-sm"><i data-lucide="settings" class="w-3 h-3"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Governance -->
                    <div x-show="peftStudio.step === 6" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Governance</h3>
                        <div class="space-y-4">
                            <div class="gh-card p-3 bg-transparent border border-[#333]">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" x-model="peftStudio.draft.dp_enabled"
                                        class="accent-[#ff5722]">
                                    <div>
                                        <div class="font-bold">Differential Privacy</div>
                                        <div class="text-xs text-[#666]">Add DP-SGD noise.</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: Review -->
                    <div x-show="peftStudio.step === 7" class="gh-card">
                        <h3 class="font-semibold mb-4 text-lg border-b border-[#333] pb-2">Review</h3>
                        <div class="grid grid-cols-2 gap-4 text-xs font-mono mb-4">
                            <div class="p-3 bg-[#111] border border-[#333]">
                                <div class="text-[#666] mb-1">CONFIG</div>
                                <div x-text="'Backend: ' + peftStudio.draft.training_config.backend"></div>
                                <div x-text="'Model: ' + peftStudio.draft.training_config.model_name_or_path">
                                </div>
                            </div>
                        </div>
                        <div class="p-3 bg-orange-dim border border-orange text-orange text-xs">
                            Ready to launch training run.
                        </div>
                    </div>

                    <!-- Step 8: Monitor -->
                    <div x-show="peftStudio.step === 8" class="gh-card">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-lg"
                                    x-text="'Run: ' + (peftStudio.run.run_id || 'Starting...')"></h3>
                                <div class="flex items-center gap-2 mt-1">
                                    <span class="badge"
                                        :class="peftStudio.run.status === 'completed' ? 'badge-success' : 'badge-warning'"
                                        x-text="peftStudio.run.status"></span>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button class="btn" @click="peftStudio.actions.promote('stable')"
                                    :disabled="peftStudio.run.status !== 'completed'">
                                    <i data-lucide="check-circle" class="w-4 h-4"></i> Promote
                                </button>
                                <button class="btn" @click="peftStudio.step = 1">
                                    <i data-lucide="rotate-ccw" class="w-4 h-4"></i> New
                                </button>
                            </div>
                        </div>
                        <div class="w-full bg-[#111] h-2 rounded-full overflow-hidden mb-4 border border-[#333]">
                            <div class="bg-orange-500 h-full transition-all duration-500"
                                :style="'width: ' + peftStudio.run.progress + '%'"></div>
                        </div>
                    </div>
                </div> <!-- End Wizard Content -->
            </div> <!-- End PEFT Grid -->

            <div class="log-stream" id="runLogs">
                <template x-for="log in peftStudio.run.logs">
                    <div class="mb-1" x-text="log"></div>
                </template>
            </div>
        </div>
        >>>>>>> 5a99ad8 (feat: realign N8n, Eval Arena, and PEFT for Robotics VLA workflows)
    </div>

    <!-- Wizard Navigation -->
    <div class="flex justify-between mt-6">
        <button class="btn" @click="peftStudio.step--"
            :disabled="peftStudio.step === 1 || peftStudio.step === 8">Back</button>
        <button class="btn btn-primary" @click="peftStudio.step++" x-show="peftStudio.step < 7">Next</button>
        <button class="btn btn-primary" @click="peftStudio.actions.startRun()" x-show="peftStudio.step === 7">Launch
            Fine-Tuning</button>
    </div>
    </div>


    <!-- Lineage Tab -->
    <div x-show="activeTab === 'lineage'" x-transition x-cloak>
        <div class="gh-header">
            <h2 class="text-xl font-semibold">Model Lineage & Runs</h2>
            <span class="text-xs text-[#8b949e]">Provenance Tracking</span>
        </div>

        <div class="gh-card">
            <table class="w-full text-left text-xs">
                <thead>
                    <tr class="text-[#8b949e] border-b border-[#30363d]">
                        <th class="pb-2">Run ID</th>
                        <th class="pb-2">Git Commit</th>
                        <th class="pb-2">SDK</th>
                        <th class="pb-2">Created</th>
                        <th class="pb-2">Status</th>
                        <th class="pb-2 text-right">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-[#30363d]">
                    <template x-for="run in runs" :key="run.run_id">
                        <tr class="hover:bg-[#161b22]">
                            <td class="py-3 font-mono text-[#58a6ff]" x-text="run.run_id.substring(0,8)">
                            </td>
                            <td class="py-3 font-mono text-[#8b949e]"
                                x-text="run.git_commit ? run.git_commit.substring(0,7) : '-'"></td>
                            <td class="py-3" x-text="run.sdk_version"></td>
                            <td class="py-3 text-[#8b949e]" x-text="formatDate(run.created_at)"></td>
                            <span :class="getStatusColor(run.status)" class="font-bold" x-text="run.status"></span>
                            </td>
                            <td class="py-3 text-right">
                                <button class="btn btn-xs border-[#30363d] hover:border-sky-500 hover:text-sky-400"
                                    @click.stop="deployPackage(run.run_id)">
                                    <i data-lucide="rocket" class="w-3 h-3 mr-1"></i> Deploy
                                </button>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Compliance Registry Tab (Restored) -->
    <div x-show="activeTab === 'compliance'" x-transition x-cloak>
        <div class="gh-header">
            <div>
                <h2 class="text-xl font-semibold">Compliance Registry</h2>
                <span class="text-xs text-[#8b949e]">TGSP Packages & Security Profiles</span>
            </div>
            <button class="btn" @click="fetchTGSP()">Refresh Registry</button>
        </div>

        <div class="grid grid-cols-3 gap-6">
            <!-- Left: Stats -->
            <div class="space-y-6">
                <div class="gh-card">
                    <h4 class="text-[10px] font-bold uppercase tracking-widest text-[#8b949e] mb-2">Registry
                        Health
                    </h4>
                    <div class="flex items-end gap-2">
                        <span class="text-3xl font-bold font-mono text-white">98.2%</span>
                        <span class="text-xs text-emerald-400 mb-1">Pass Rate</span>
                    </div>
                    <div class="mt-4 space-y-2">
                        <div class="flex justify-between text-xs">
                            <span class="text-[#8b949e]">Signatures Verified</span>
                            <span class="text-white">12,402</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="text-[#8b949e]">Malicious Pkgs</span>
                            <span class="text-red-400">0</span>
                        </div>
                    </div>
                </div>

                <div class="gh-card bg-[#161b22]/50 border-dashed">
                    <div class="flex flex-col items-center justify-center py-6 text-center">
                        <i data-lucide="upload-cloud" class="w-8 h-8 text-[#30363d] mb-2"></i>
                        <h5 class="text-xs font-semibold text-[#c9d1d9]">Upload TGSP</h5>
                        <p class="text-[10px] text-[#8b949e] mt-1 max-w-[150px]">Drag & drop signed packages
                            to
                            undergo verification.</p>
                    </div>
                </div>
            </div>

            <!-- Right: Packages List -->
            <div class="col-span-2">
                <div class="gh-card">
                    <h4 class="text-sm font-semibold mb-4 text-[#c9d1d9]">Verified Packages</h4>

                    <div class="space-y-3">
                        <template x-if="loading.tgsp">
                            <div class="space-y-3">
                                <div class="skeleton h-16 w-full rounded"></div>
                                <div class="skeleton h-16 w-full rounded"></div>
                                <div class="skeleton h-16 w-full rounded"></div>
                            </div>
                        </template>

                        <template x-if="!loading.tgsp && tgspPackages.length === 0">
                            <div class="text-center py-10">
                                <span class="text-[#8b949e] text-xs">No active profiles found.</span>
                            </div>
                        </template>

                        <template x-for="pkg in tgspPackages" :key="pkg.id">
                            <div
                                class="p-3 border border-[#30363d] rounded bg-[#0d1117] hover:border-[#58a6ff] transition-colors group">
                                <div class="flex justify-between items-start">
                                    <div class="flex items-start gap-3">
                                        <div
                                            class="w-8 h-8 rounded bg-[#1f6feb]/20 flex items-center justify-center mt-1">
                                            <i data-lucide="package" class="w-4 h-4 text-[#58a6ff]"></i>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-bold text-[#58a6ff] group-hover:underline"
                                                x-text="pkg.name"></h5>
                                            <div class="flex items-center gap-2 mt-1">
                                                <span
                                                    class="text-[10px] bg-[#30363d] px-1.5 py-0.5 rounded text-[#c9d1d9] font-mono"
                                                    x-text="'v' + pkg.version"></span>
                                                <span class="text-[10px] text-[#8b949e]"
                                                    x-text="'ID: ' + pkg.id"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col items-end gap-1">
                                        <span class="gh-badge gh-badge-success flex items-center gap-1">
                                            <i data-lucide="check-circle" class="w-3 h-3"></i> Signed
                                        </span>
                                        <span class="text-[10px] text-[#8b949e]"
                                            x-text="formatDate(pkg.uploaded_at)"></span>
                                    </div>
                                </div>

                                <i data-lucide="container" class="w-3 h-3 text-emerald-400"></i>
                                <span class="text-[10px] text-[#8b949e]">Container</span>
                            </div>
                            <div class="ml-auto">
                                <button class="text-[10px] text-[#58a6ff] hover:text-white font-medium">View
                                    Report</button>
                            </div>
                    </div>
                </div>
                </template>
            </div>
        </div>
    </div>
    </div>
    </div>

    <!-- Key Vault (KMS) Tab -->
    <div x-show="activeTab === 'vault'" x-transition x-cloak>
        <div class="gh-header">
            <div>
                <h2 class="text-xl font-semibold">Enterprise KMS Manager</h2>
                <span class="text-xs text-[#8b949e]">Key Lifecycle & Fleet Policy</span>
            </div>
            <div class="flex gap-2">
                <button class="btn" @click="rotateMasterKey()">Rotate Master Key</button>
                <button class="btn btn-primary" @click="provisionFleetKey()">Provision New Fleet
                    Key</button>
            </div>
        </div>

        <div class="kms-grid">
            <div class="space-y-4">
                <div class="gh-card">
                    <h4 class="text-sm font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="key" class="text-amber-500 w-4 h-4"></i> Active Cryptographic Fleet
                    </h4>
                    <div class="space-y-0">
                        <template x-for="cert in certificates.slice(0, 5)" :key="cert.id">
                            <div
                                class="key-status-row hover:bg-[#1c2128] rounded-md transition-colors cursor-pointer group">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded bg-amber-500/10 flex items-center justify-center">
                                        <i data-lucide="shield"
                                            class="w-4 h-4 text-amber-500 group-hover:animate-pulse"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="font-mono text-xs text-[#58a6ff]"
                                            x-text="cert.id.substring(0,12)"></span>
                                        <span class="text-[10px] text-[#8b949e]"
                                            x-text="cert.subject_common_name"></span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-6">
                                    <div class="flex flex-col items-end">
                                        <span
                                            class="text-[9px] uppercase font-bold text-[#8b949e] tracking-tight">Primitive</span>
                                        <span class="text-[11px] font-mono"
                                            x-text="cert.is_pqc ? 'Dilithium-3' : 'mTLS-RSA-4k'"></span>
                                    </div>
                                    <div class="w-24 text-right">
                                        <span :class="getCertExpiryClass(cert.days_to_expiry)"
                                            class="text-[10px] px-2 py-0.5 rounded-full font-bold bg-white/5"
                                            x-text="cert.days_to_expiry + 'd remaining'"></span>
                                    </div>
                                    <button class="text-[#8b949e] hover:text-white transition-colors"
                                        title="Rotate Locally" @click="rotateKey(cert.id)">
                                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <div class="gh-card">
                    <h4 class="text-[10px] font-bold uppercase tracking-widest text-[#8b949e] mb-4">KMS
                        Access
                        Policies
                    </h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div
                            class="p-4 bg-black/20 rounded border border-[#30363d] hover:border-[#58a6ff]/50 transition-colors">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-xs font-semibold text-[#c9d1d9]">Auto-Rotation</span>
                                <span class="gh-badge gh-badge-success">ACTIVE</span>
                            </div>
                            <div class="text-2xl font-bold font-mono text-white">30d <span
                                    class="text-xs font-normal text-[#8b949e]">TTL</span></div>
                            <p class="text-[10px] text-[#8b949e] mt-2">PQC leaf keys are rotated every 30
                                days
                                automatically.</p>
                        </div>
                        <div
                            class="p-4 bg-black/20 rounded border border-[#30363d] hover:border-[#58a6ff]/50 transition-colors">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-xs font-semibold text-[#c9d1d9]">TEE Attestation</span>
                                <span class="gh-badge gh-badge-success">ENFORCED</span>
                            </div>
                            <div class="text-2xl font-bold font-mono text-white">Lv. 4 <span
                                    class="text-xs font-normal text-[#8b949e]">HARD</span></div>
                            <p class="text-[10px] text-[#8b949e] mt-2">Hardware-backed evidence fabric
                                required for
                                all
                                unwrap calls.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="gh-card">
                <h4 class="text-[10px] font-bold uppercase tracking-widest text-[#8b949e] mb-6">
                    Cryptographic Health
                </h4>
                <div class="flex flex-col items-center">
                    <div class="crypto-health-ring relative">
                        <svg width="120" height="120" class="-rotate-90">
                            <circle cx="60" cy="60" r="50" fill="none" class="stroke-[#30363d]" stroke-width="8">
                            </circle>
                            <circle cx="60" cy="60" r="50" fill="none" class="stroke-emerald-500" stroke-width="8"
                                stroke-dasharray="314.15" stroke-dashoffset="31.4" stroke-linecap="round"></circle>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-2xl font-bold text-emerald-500">90%</span>
                        </div>
                    </div>
                    <div class="text-center mt-6">
                        <div class="text-xs font-bold text-[#c9d1d9]">Quantum-Secure Readiness</div>
                        <p class="text-[11px] text-[#8b949e] mt-1 leading-relaxed px-4">
                            9 of 10 active certificates are currently utilizing Post-Quantum algorithms
                            (Dilithium/Kyber).
                        </p>
                    </div>

                    <div class="w-full mt-8 pt-6 border-t border-[#30363d]">
                        <h5 class="text-[10px] uppercase font-bold text-[#8b949e] mb-4">Recent Audit Proofs
                        </h5>
                        <div class="space-y-4">
                            <div class="flex items-center gap-2 group">
                                <div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div>
                                <span class="text-[11px] text-[#c9d1d9]">K7-FLEET: Rotation Signature</span>
                                <span class="text-[10px] text-[#8b949e] ml-auto">2h ago</span>
                            </div>
                            <div class="flex items-center gap-2 group">
                                <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                                <span class="text-[11px] text-[#c9d1d9]">N2-SIG: HSM Policy Sync</span>
                                <span class="text-[10px] text-[#8b949e] ml-auto">5h ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audit Tab -->
    <div x-show="activeTab === 'audit'" x-transition x-cloak>
        <div class="gh-header">
            <div>
                <h2 class="text-xl font-semibold">Immutable Audit Trail</h2>
                <span class="text-xs text-[#8b949e]">Cryptographic Traceability</span>
            </div>
            <button @click="fetchAudit()" class="btn">
                <i data-lucide="refresh-cw" class="w-3 h-3 inline mr-1"
                    :class="loading.audit ? 'animate-spin' : ''"></i>
                Sync Records
            </button>
        </div>

        <div class="gh-card p-0 overflow-hidden">
            <template x-if="loading.audit && auditLogs.length === 0">
                <div class="p-8 space-y-4">
                    <template x-for="i in 5">
                        <div class="flex items-center gap-4">
                            <div class="skeleton h-4 w-1/4"></div>
                            <div class="skeleton h-4 w-1/2"></div>
                            <div class="skeleton h-4 w-1/4"></div>
                        </div>
                    </template>
                </div>
            </template>

            <template x-if="!loading.audit && auditLogs.length > 0">
                <table class="w-full text-left text-sm border-collapse">
                    <thead>
                        <tr class="text-[#8b949e] border-b border-[#30363d] bg-black/10">
                            <th class="p-4 font-bold text-[10px] uppercase tracking-wider">Timestamp</th>
                            <th class="p-4 font-bold text-[10px] uppercase tracking-wider">Actor Context
                            </th>
                            <th class="p-4 font-bold text-[10px] uppercase tracking-wider">Action</th>
                            <th class="p-4 font-bold text-[10px] uppercase tracking-wider">Target Resource
                            </th>
                            <th class="p-4 font-bold text-[10px] uppercase tracking-wider text-right">
                                Integrity Hash
                            </th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-[#30363d]">
                        <template x-for="log in auditLogs" :key="log.id">
                            <tr class="hover:bg-[#1c2128] transition-colors">
                                <td class="p-4 text-xs text-[#8b949e] whitespace-nowrap"
                                    x-text="formatDate(log.timestamp)"></td>
                                <td class="p-4">
                                    <div class="flex flex-col">
                                        <span class="text-xs font-bold text-[#58a6ff]" x-text="log.actor_type"></span>
                                        <span class="text-[10px] text-[#8b949e] font-mono"
                                            x-text="log.actor_id.substring(0,12)"></span>
                                    </div>
                                </td>
                                <td class="p-4">
                                    <span class="badge badge-info" x-text="log.action"></span>
                                </td>
                                <td class="p-4">
                                    <div class="flex flex-col">
                                        <span class="text-xs text-[#c9d1d9]" x-text="log.target_type"></span>
                                        <span class="text-[10px] text-[#8b949e] font-mono"
                                            x-text="log.target_id.substring(0,12)"></span>
                                    </div>
                                </td>
                                <td class="p-4 text-right">
                                    <span class="text-[10px] font-mono text-[#444c56] hover:text-[#8b949e] cursor-help"
                                        :title="log.entry_hash" x-text="log.entry_hash.substring(0,16)"></span>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>

            <template x-if="!loading.audit && auditLogs.length === 0">
                <div class="flex flex-col items-center justify-center py-20 text-center">
                    <div class="w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-4">
                        <i data-lucide="clipboard-list" class="w-8 h-8 text-[#30363d]"></i>
                    </div>
                    <h4 class="text-md font-semibold text-[#c9d1d9]">No security events found</h4>
                    <p class="text-sm text-[#8b949e] max-w-xs mt-2">The tamper-proof ledger is currently
                        empty.
                        Events
                        will appear here as they are processed.</p>
                </div>
            </template>
        </div>
    </div>
    <!-- Fleets & Devices Tab -->
    <div x-show="activeTab === 'fleets'" x-transition x-cloak>
        <div class="gh-header">
            <h2 class="text-xl font-semibold">Fleets & Devices</h2>
            <button class="btn btn-primary" @click="generateEnrollmentToken()">
                <i data-lucide="plus" class="w-4 h-4"></i> New Enrollment Token
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <template x-for="fleet in fleets" :key="fleet.id">
                <div class="gh-card hover:border-[#58a6ff] transition-colors cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center gap-3">
                            <div
                                class="w-10 h-10 rounded bg-[#161b22] border border-[#30363d] flex items-center justify-center">
                                <i data-lucide="server" class="w-5 h-5 text-[#8b949e]"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-sm" x-text="fleet.name"></h3>
                                <p class="text-xs text-[#8b949e]" x-text="fleet.region"></p>
                            </div>
                        </div>
                        <span class="badge badge-success" x-text="fleet.status"></span>
                    </div>
                    <div class="flex justify-between text-xs text-[#8b949e] border-t border-[#30363d] pt-3">
                        <span><strong class="text-white" x-text="fleet.devices_online"></strong> / <span
                                x-text="fleet.devices_total"></span> Online</span>
                        <span>Trust: <strong class="text-emerald-400" x-text="fleet.trust_score + '%'"></strong></span>
                    </div>
                    <div class="absolute top-4 right-14 opacity-0 group-hover:opacity-100 transition-opacity">
                        <button class="btn btn-sm border-red-500 text-red-500"
                            @click.stop="revokeFleet(fleet.id)">Revoke</button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Global Settings Tab -->
    <div x-show="activeTab === 'settings'" x-transition x-cloak>
        <div class="gh-header">
            <h2 class="text-xl font-semibold">Global Settings</h2>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- KMS Configuration -->
            <div class="gh-card">
                <h3 class="font-bold text-sm mb-4 flex items-center gap-2">
                    <i data-lucide="key" class="w-4 h-4 text-orange-500"></i> Key Management Service (KMS)
                </h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-[#8b949e] mb-1">Provider</label>
                        <select x-model="settings.kms.provider" title="KMS Provider Selector"
                            class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-sm text-white focus:border-orange-500 outline-none">
                            <option value="local">Local Development</option>
                            <option value="aws">AWS KMS</option>
                            <option value="azure">Azure Key Vault</option>
                            <option value="gcp">Google Cloud KMS</option>
                        </select>
                    </div>

                    <template x-if="settings.kms.provider !== 'local'">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-bold text-[#8b949e] mb-1">Resource ARN / URL</label>
                                <input type="text" x-model="settings.kms.resource_id"
                                    placeholder="arn:aws:kms:us-east-1:..."
                                    class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-sm text-white focus:border-orange-500 outline-none">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-[#8b949e] mb-1">Client Secret
                                    (Encrypted)</label>
                                <input type="password" placeholder="â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢"
                                    class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-sm text-white focus:border-orange-500 outline-none">
                            </div>
                        </div>
                    </template>

                    <div class="pt-2">
                        <button class="btn w-full justify-center" @click="testKMSConnection()">
                            <i data-lucide="link" class="w-3 h-3"></i> Test Connection
                        </button>
                    </div>
                </div>
            </div>

            <!-- RTPL Privacy Config -->
            <div class="gh-card">
                <h3 class="font-bold text-sm mb-4 flex items-center gap-2">
                    <i data-lucide="ghost" class="w-4 h-4 text-orange-500"></i> RTPL Privacy Defense
                </h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-[#8b949e] mb-1">Defense Mode</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button class="btn text-xs justify-center"
                                :class="settings.rtpl.mode === 'front' ? 'btn-primary' : ''"
                                @click="settings.rtpl.mode = 'front'">
                                FRONT (Rayleigh)
                            </button>
                            <button class="btn text-xs justify-center"
                                :class="settings.rtpl.mode === 'wtf-pad' ? 'btn-primary' : ''"
                                @click="settings.rtpl.mode = 'wtf-pad'">
                                WTF-PAD
                            </button>
                            <button class="btn text-xs justify-center"
                                :class="settings.rtpl.mode === 'padding' ? 'btn-primary' : ''"
                                @click="settings.rtpl.mode = 'padding'">
                                Padding Only
                            </button>
                        </div>
                        <p class="text-[10px] text-[#8b949e] mt-1" x-show="settings.rtpl.mode === 'front'">
                            Injects dummy packets at start of bursts. Zero latency, moderate overhead.
                        </p>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-[#8b949e] mb-1">Determinism Profile</label>
                        <select x-model="settings.rtpl.profile" title="RTPL Determinism Profile"
                            class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-sm text-white focus:border-orange-500 outline-none">
                            <option value="surgical">Surgical (Strict &lt; 0.5ms jitter)</option>
                            <option value="collaborative">Collaborative (General Purpose)</option>
                            <option value="warehouse">Warehouse (High Latency Tolerance)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </main>
    </div>
    </div>

    <script src="app.js"></script>
    <script>
        document.addEventListener('alpine:initialized', () => {
            lucide.createIcons();
        });
        window.addEventListener('tab-changed', () => {
            lucide.createIcons();
            // Re-run icons when individual tabs might have new content
            setTimeout(() => lucide.createIcons(), 10);
        });
    </script>
</body>

</html>